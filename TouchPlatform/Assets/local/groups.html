<!DOCTYPE html>
<html>
<head>
    <title>分组管理</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width" />

    <!-- Bootstrap core CSS -->
    <link href="../library/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../library/css/font-awesome.min.css" rel="stylesheet">
    <!-- ionicons -->
    <link href="../library/css/ionicons.min.css" rel="stylesheet">
    <!-- Simplify -->
    <link href="../library/css/simplify.css" rel="stylesheet">

    <link href="../css/style.css" rel="stylesheet">
</head>

<body class="overflow-hidden">
    <div class="preload no-footer">

        <div class="header-block" style="min-height:52px;"></div>
        <div class="menu-block"></div>

        <div class="main-container sidebar-mini">
            <div class="inbox-wrapper">
                <div class="inbox-body padding-md">
                    <div class="pagination-row clearfix m-bottom-md">
                        <div class="col-md-6">
                            <div class="col-md-6 text-left-sm">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                    操作
                                    <span class="btn-command-icon"><span class="caret"></span></span>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                </ul>


                            </div>
                        </div>


                        <div class="col-md-3 pull-right pull-left-sm text-right">

                            <div class="col-md-2 inline-block input-group">
                                <a class="btn-freshen btn btn-success no-shadow" href="javascript:;">
                                    <i class="fa fa-refresh" aria-hidden="true"></i>
                                </a>
                            </div>
                        </div>
                    </div><!-- ./pagination-row -->
                    <div class="message-table table-responsive">
                        <table class="table table-bordereds">
                            <thead>
                                <tr>
                                    <th class="text-center">
                                        <div class="custom-checkbox">
                                            <input type="checkbox" id="chkAll" class="inbox-check">
                                            <label for="chkAll"></label>
                                        </div>
                                    </th>
                                    <th></th>
                                    <th>分组名称</th>
                                    <th>排序号</th>
                                    <th>AuthKey</th>
                                    <th>更新时间</th>
                                    <th>当前脚本</th>
                                </tr>
                            </thead>
                            <tbody id="tr-panel"></tbody>
                        </table>
                    </div><!-- ./message-table -->

                </div><!-- ./inbox-body -->
            </div><!-- ./inbox-wrapper -->
        </div>



        <!--查看分组信息-->
        <div class="overlap detail-panel">
            <div class="header-mini"></div>
            <div class="smart-widget col-xs-12">
                <div class="smart-widget-header">
                    查看分组信息
                    <span class="smart-widget-option">
                        <a href="javascript:" onclick="$('.detail-panel').hide()" class="widget-remove-option">
                            <i class="fa fa-times"></i>
                        </a>
                    </span>
                </div>
                <div class="smart-widget-inner" id="detail-panel">
                    <div class="smart-widget-body">
                        <form id="g-form" method="post" class="form-horizontal no-margin form-border">
                            <div class="form-group">
                                <label class="col-lg-2 control-label">组别名称</label>
                                <div class="col-lg-8">
                                    <input type="hidden" name="id" value="" />
                                    <input class="form-control groupname" name="groupname" type="text" placeholder="请输入组别名称...">
                                </div><!-- /.col -->
                            </div><!-- /form-group -->
                            <div class="form-group">
                                <label class="col-lg-2 control-label">排序</label>
                                <div class="col-lg-8">
                                    <input class="form-control sortcode" name="sortcode" type="number" placeholder="排序号...">
                                </div><!-- /.col -->
                            </div>


                            <div class="form-group">
                                <label class="col-lg-2 control-label"></label>
                                <div class="col-lg-4">
                                    <a href="javascript:;" onclick="SaveGroupDetai()" class="btn-save btn btn-danger">保存</a>
                                    <a href="javascript:;" onclick="$('.detail-panel').hide()" class="btn-canel btn btn-default">取消</a>
                                </div>
                            </div>
                        </form>
                    </div>
                </div><!-- ./smart-widget-inner -->
            </div>
        </div>

    </div>

    <a href="#" class="scroll-to-top hidden-print"><i class="fa fa-chevron-up fa-lg"></i></a>

    <script id="tr-template" type="text/html">
        {{each data as d i}}
        <tr class="tr{{d.ID}}">
            <td class="text-center">
                <div class="custom-checkbox">
                    <input type="checkbox" id="chk{{d.ID}}" value="{{d.ID}}" class="inbox-check">
                    <label for="chk{{d.ID}}"></label>
                </div>
            </td>
            <td></td>
            <td>
                <a href="javascript:" onclick="openpanel('{{d.ID}}')">{{d.groupname}}</a>
            </td>
            <td>
                {{d.sortcode}}
            </td>
            <td>
                ********
            </td>
            <td>
                {{d.lastTime}}
            </td>
            <td>{{d.luapath}}</td>
        </tr>
        {{/each}}
    </script>


    <!-- Jquery -->
    <script src="../library/js/jquery-1.11.1.min.js"></script>

    <!-- Bootstrap -->
    <script src="../library/bootstrap/js/bootstrap.min.js"></script>

    <!-- Slimscroll -->
    <script src="../library/js/jquery.slimscroll.min.js"></script>

    <!-- Popup Overlay -->
    <script src="../library/js/jquery.popupoverlay.min.js"></script>
    <!-- Modernizr -->
    <script src="../library/js/modernizr.min.js"></script>


    <!-- Easy Pie Chart -->
    <script src='../library/js/jquery.easypiechart.min.js'></script>

    <!-- Owl Carousel -->
    <script src='../library/js/owl.carousel.min.js'></script>

    <!-- Datepicker -->
    <script src='../library/js/uncompressed/datepicker.js'></script>

    <script src="../js/lib/artTemplate/template.js"></script>

    <script src="../js/base.js"></script>
    <script src="../js/authAction.js"></script>

    <!-- Simplify -->
    <script src="../library/js/simplify/simplify.js"></script>

    <script type="text/javascript">

        $(function () {
            bindCheckbox();

            $.ajax({
                type: 'POST',
                url: domain + "/api/Grouplist",
                dataType: 'json',
                data: {},
                success: function (data) {
                    var html = template('tr-template', data);
                    $("#tr-panel").html(html);
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    //alert("XMLHttpRequest:" + XMLHttpRequest + ",textStatus" + textStatus + ",errorThrown" + errorThrown);
                    console.log('error:BindDevice');
                }
            });

        });


        function openpanel(id) {
            $.ajax({
                type: 'POST',
                url: domain + "/api/GroupDetail",
                dataType: 'json',
                data: { id: id },
                success: function (data) {
                    $('.detail-panel').show();
                    $('#g-form input[name=id]').val(data.data.ID);
                    $('#g-form input[name=groupname]').val(data.data.groupname);
                    $('#g-form input[name=sortcode]').val(data.data.sortcode);
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    console.log('error:GroupDetail');
                }
            });
        }

        function SaveGroupDetai() {
            $.ajax({
                type: 'POST',
                url: domain + "/api/addGroup",
                dataType: 'json',
                data: $("#g-form").serialize(),
                success: function (data) {
                    alert(data.message);
                    if (data.code == 200) {
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    //alert("XMLHttpRequest:" + XMLHttpRequest + ",textStatus" + textStatus + ",errorThrown" + errorThrown);
                    console.log('error:.btn-addGroup');
                }
            });
        }

    </script>

</body>
</html>
